---
title: "How to enable a disabled Local Administrator account offline in Windows 7 (even when using BitLocker)"
date: 2010-10-11 13:00:00
author: admin
categories: ["Best Practice", "Tutorials"]
tags: ["Advanced", "Bitlocker", "Enable", "Local Administrator", "offline", "Recovery Key", "Security", "Windows 7"]
featured_image: "https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb6.png"
---

Back in the days of Windows XP IT administrators could disable the local administrator account on domain joined computers but still be able to use the account if they rebooted the computer into safe mode (see [How to access the computer after you disable the administrator account](<http://support.microsoft.com/kb/814777>) ).

> [To log on to Windows by using the disabled local Administrator account, start Windows in Safe mode.](<http://support.microsoft.com/kb/814777>)

However this behaviour has change since Windows Vista (and 7) and now you are no longer able to logon to a computers local administrator account if it is disabled (see [Built-in Administrator Account Disabled](<http://blogs.msdn.com/b/windowsvistasecurity/archive/2006/08/27/windowsvistasecurity-.aspx> "http://blogs.msdn.com/b/windowsvistasecurity/archive/2006/08/27/windowsvistasecurity-.aspx") ).

> [On domain joined computers, the disabled built-in administrator account cannot logon in safe mode](<http://blogs.msdn.com/b/windowsvistasecurity/archive/2006/08/27/windowsvistasecurity-.aspx>)

This presents some challenges as IT administrator as sometime you still need to ability to logon to a computer using the local administrator. The most common scenario you need to do this is when you need to troubleshoot domain account issues (e.g. re-join the computer to the domain) when the AD computer account has been reset or deleted or the password has become out of sync and you get a workstation trust relationship issue (see below). [![The security database on teh server does not have a comptuer accounf for this workstation trust relationship.](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb6.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image6.png>) The problem is that the local administrator account is now disabled and due to the new behaviour of the account you can no longer log with it using safe mode.

> [The built-in administrator account is disabled by default in Windows Vista on new installations.](<http://blogs.msdn.com/b/windowsvistasecurity/archive/2006/08/27/windowsvistasecurity-.aspx>)

This of course makes it almost impossible to configure the computer into a workgroup so that it can then be re-added to the domain to fix the problem. Its even more difficult if you have BitLocker encryption enabled on your local hard drive. It is possible that you could logon with a user with local administrator access using cached credentials however this is limited to the last 10 people that logged on (increasable to 50 if you change the CachedLogonsCount below registry key). [![CachedLogonsCount Registry Key](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb7.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image7.png>) But even so, this would also mean you have to know the username and password of the account at the time they last logged onto the computer. This may be a bit hard to do as they may have changed their password a number of times since they logged on to that computer. Unfortunately, it is also much more unlikely now that the normal local user of the computer has not been given local admin due to all the improvement with Windows 7 (e.g. UAC) that allows users to work with standard user permissions. Now you might think the really obvious solution is to just enable the local administrator account and set a password in advanced using [Group Policy Preferences](<https://www.grouppolicy.biz/2010/03/what-are-group-policy-preferences/>) (see below) so that you can use it when you need to however doing this has a few security issues. [![Group Policy Prefereces - New Local User Properties](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb8.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image8.png>) However enabling the local administrator account means it can be used by anyone who knows the credentials and they could then use the account to remotely access any workstation on the network (not good). It also mean a normal user that knows the local admin credentials ( we would like to think they don't but somehow they find out) could us them whenever they are presented with a specify credentials UAC prompt. So it's pretty much a back door that anyone can use to get around the fact you spent all this time setting up their computers for them to not require local administrator access"... So to get around this issues you could just set the password on a regular basis using Group Policy Preference (see above image) however this also has a few problems as well"... While setting the local administrator password is easy to do however it is stored in the SYSVOL as an encrypted string that is fairly easy to crack (see [Passwords in Group Policy Preferences](<http://blogs.technet.com/b/grouppolicy/archive/2008/08/04/passwords-in-group-policy-preferences.aspx>) ).

> [A password in a preference item is stored in SYSVOL "..... it is not stored as clear text in the XML source code of the preference item. However, the password is not secured.](<http://blogs.technet.com/b/grouppolicy/archive/2008/08/04/passwords-in-group-policy-preferences.aspx>)

To help mitigate this I have also written an article that explain a way to more securely apply the new password to all the computers (see [How to use Group Policy Preferences to change account Passwords](<https://www.grouppolicy.biz/2010/01/how-to-use-group-policy-preferences-to-set-change-passwords/>) ) but even if you did this on a regular basis you would still need to tell all the IT support staff what the new password is when you change the password and thus people quickly learn the local admin account credentials all over again"... **Note:** That all being said it is still a really good idea to set a password for the local administrator account as the default password is configured as blank. The other solution you might think of is to boot the computer using a third-party tool that can reset and enable the local admin account (see [http://www.bing.com/search?q=sethc.exe+%22windows+7%22+administrator+password&form=QBRE&qs=n&sk=](<http://www.bing.com/search?q=sethc.exe+%22windows+7%22+administrator+password&form=QBRE&qs=n&sk=> "http://www.bing.com/search?q=sethc.exe+%22windows+7%22+administrator+password&form=QBRE&qs=n&sk=") ) however these tools don't work if your local drive is encrypted with BitLocker nor are they supported from Microsoft (see [Microsoft policy about lost or forgotten passwords](<http://support.microsoft.com/kb/189126> "http://support.microsoft.com/kb/189126") ).

> [If you want help to break or to reset a password, you can locate and contact a third-party company for this help. You use such third-party products and services at your own risk.](<http://support.microsoft.com/kb/189126>)

So lets assume you have a computer that is no longer properly connected to the domain with a disabled local administrator account. The computers local system drive is BitLocker encrypted and and you don't know the credentials of any other accounts that have previously logged on with local administrator permissions"... What do you do? So below I will show you how to enable the local administrator account so that you can at least still logon with the local administrator even if the account has been disabled"...

### How to enable a disabled local administrator account on a Windows 7 computer with BitLocker enabled

Before you begin you are going to at a minimum know the following information:

  * The account name and password of the local administrator account.
  * The BitLocker recovery key for the local system drive. (see instruction on how to get the key from here [How to use Group Policy to save "BitLocker to Go" recovery keys in Active Directory "“ Part 1](<https://www.grouppolicy.biz/2010/01/how-to-use-group-policy-to-save-bitlocker-to-go-recovery-keys-in-active-directory-part-1/>) )

Step 1. Boot the computer using the Windows 7 Installation media Step 2. When prompted to "Install now" click the "Repair your computer" option at the bottom left. [![Windows 7 Install Windows Menu](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb9.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image9.png>) Step 3 (optional). If your local computer hard drive is BitLocker is encrypted you will now be prompted to type in the recovery key (see below) and just follow the next couple of step that is appropriate for your situation. **Note:** You may need to use the Recovery Key Identifier (e.g. A5103515) to find the correct encryption recovery key from Active Directory. **Note2:**  This step is only required if your local hard drive is encrypted using BitLocker drive encryption. [![BitLocker Drive Encryption Recovery](https://www.grouppolicy.biz/wp-content/uploads/2010/10/photo_thumb.jpg)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/photo.jpg>) Step 4. After you have entered the correct recovery and unlocked the drive select the appropriate installation of Windows 7 that you wish to gain access to (You will probably only have one option to select). [![WinRE Select System Recovyer Option](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb10.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image10.png>) **Note:** Remember the drive letter in the location column as you will need to use this later (Almost definitely going to be "(D:) Local Disk" ). Step 5. From the System Recovery Options click on "Command Prompt" [![WinRE System Recovery Options](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb11.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image11.png>) Step 6. Now run "regedit" from the command prompt. [![Regedit in WinRE](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb12.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image12.png>) Step 7. Click on HKEY_USERS and then click on File > Load Hive [![Load Hive...](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb13.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image13.png>) Step 8. Navigate to D:\Windows\System32\Config folder and select the SAM file then click Open **Note:**  The drive letter you use in the path above is the same as the the drive letter in the Location column in Step 4. [![Loading SAM registry](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb14.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image14.png>) Step 9. Now type "SAM_TEMP" (or any value) in the Key Name text field and click OK [![Load Hive Name](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb15.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image15.png>) Step 10. Expand SAM_TEMP\SAM\Domains\Account\Users\000001F4 and double click on the "F" key. [![Local Administrator Account SAM registry](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb16.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image16.png>) Step 11. Change the value "11" in the first column, row 0038 to "10" and click OK  Before | After
---|---
[![Account Disabled](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb17.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image17.png>) | [![Account Enabled](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb18.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image18.png>)
Step 12. Click back on "SAM_TEMP" and then from the File > Unload Hive and Yes to confirm. [![Unload Hive...](https://www.grouppolicy.biz/wp-content/uploads/2010/10/image_thumb19.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/10/image19.png>) Step 13. Exit Regedit and close the Command Prompt and click Restart from the System Recovery Option menu Done"...

### Summary

You will now be able to logon as the local administrator account by using the account name ".\administrator" and the password of the account (which you should already know). This will enable you to configure the computer into a workgroup and then re-join the computer account back into the domain but without having to resort to enabling a back door administrator account on the all the computers in your environment"... Now you might now be wondering what is the point of security is on Windows 7 (i.e. BitLocker and disabled local admin) if it is so easy to circumvent however you need to remember that for this process to work you still need to know the local administrator password and more importantly you will need to know the unique BitLocker recovery key"... Obviously this makes it very important to have BitLocker drive encryption deployed otherwise it will make it very easy to break into pretty much any computer if you have physical access.

> [the best network software security measures can be rendered useless if you fail to physically protect your systems](<http://en.wikipedia.org/wiki/Physical_access> "http://en.wikipedia.org/wiki/Physical_access")

I know this is not strictly a Group Policy topic however it is very closely related topic and one I feel that this is still well worth knowing for any IT administrator so you can configured a more secure environment"...

### Other References

[How to configure Group Policy to use Data Recovery Agents with "Bitlocker to Go" drives "“ Part 2](<https://www.grouppolicy.biz/2010/01/how-to-configure-group-policy-to-use-data-recovery-agents-with-bitlocker-to-go-drives-part-2/>) [How to use Group Policy to save "BitLocker to Go" recovery keys in Active Directory "“ Part 1](<https://www.grouppolicy.biz/2010/01/how-to-use-group-policy-to-save-bitlocker-to-go-recovery-keys-in-active-directory-part-1/>) [Windows Seven Forums: How to Enable the Built-in Administrator Account from WinRE](<http://www.sevenforums.com/tutorials/102552-built-administrator-enable-winre.html>)