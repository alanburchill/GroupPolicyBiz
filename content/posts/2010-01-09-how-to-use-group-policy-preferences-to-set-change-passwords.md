---
title: "How to use Group Policy Preferences to change account Passwords"
date: 2010-01-09 13:17:16
author: admin
categories: ["Best Practice", "Security", "Tutorials"]
tags: ["Advanced", "Group Policy", "Password", "Security"]
featured_image: "https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb58.png"
---

_**UPDATE: If you are thinking about doing this... DON'T  this password group policy is not taken advantage of using the[MetaSploit](<http://www.rapid7.com/products/metasploit/>) tool kit (see <https://www.rapid7.com/db/modules/post/windows/gather/credentials/gpp> ). I will leave this article on line, but if you have implemented any password via Group Policy Preferences then you seriously need to look at alternatives ASAP.**_ If you are using the Group Policy Preferences to apply local user account be aware there is a security risk in doing this. In short the passwords are stored in the AD SYSVOL encrypted using AES however the encryption key is well known so this could only be considered obfuscated at best.... More info about this can be read at <http://blogs.technet.com/grouppolicy/archive/2009/04/22/passwords-in-group-policy-preferences-updated.aspx> However using Group Policy Preferences to set passwords on local user accounts is still extremely useful and one could argue that not changing the local administrator account password is potentially more of a security issue over time. So if you still want to use this option but want to mitigate the risk in using this feature then here are a few steps that can be taken that will help. Before you start tell as few as people as possible when you are changing the passwords. This is important as if you tell people when the password is changing they will know when to look for the password stored in the SYSVOL. Step 1. Change default group policy refresh period to be as short as you dare (see Image 1). The default is 90 minutes but if you can safely crank it down 5 or 10 minutes that would be better. This will speed up the propagation delay of the new password once is configured in the group policy. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb58.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image60.png>) Image 1. Changing the default group policy refresh Step 2. Some time during the middle of the day create a new group policy object and configured the the new local user password option (See image 2). then wait for the setting to propagate. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb59.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image61.png>) Image 2. Configuring the Local Account Password Step 3. Then you need to wait"... How long? The formula i would use for the time to wait is as follows:

> **Max Active Directory Propagation Delay \+ Max Group Policy Refresh Interval**

Therefore if it take 16 minutes for Group Policy changes to propagate to all DC's in the domain and you have set group policy refresh to 10 minutes the formula will look like this.

> **16 minutes **+ **(10 minutes + 2 minutes**) = **28 minutes**

Note the 2 minutes is to take into account the 20% offset that group policy refresh interval has from the set value. Step 4. Then one you have waited for the new password setting to rollout DELETE the group policy password setting you configured. This will purge the obfuscated version of the password from the SYSVOL. The reason also I recommend you create and delete a new group policy each time you do this is so the password file is store in a different path in the SYSVOL which is just another way to make it harder for someone to file the password file. Step 5. You may want to repeat steps 4, 5 and 6 a couple of days apart to ensure that you have applied the setting to all the computers that were not turned on or connected to the network the first time (sounds like a great reason to deploy [Direct Access](<http://technet.microsoft.com/en-us/network/dd420463.aspx>)). Step 6. Finally don't forget to wind back the default group policy refresh interval to its original value. Now as we are all good IT Professional it would be best to tell people that the local admin password has changed and will be disseminated securely (NOT via email or IM) when needed. The key is to do it quick and then remove the policy as soon as you are done to have the smallest window of opportunity as possible for someone to grab the password file. Of course this sound very devious and some could say you are covering your trails by deleting the policy once you are done which is not something you generally want to do as a good IT Professional"... But if you are going to do this in a organisation then your are probably going to need to follow change control anyway so you should still have an official record of what you have done. Alan Burchill