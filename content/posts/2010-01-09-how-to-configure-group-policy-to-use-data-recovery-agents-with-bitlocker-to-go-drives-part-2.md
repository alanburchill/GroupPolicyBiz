---
title: "How to configure Group Policy to use Data Recovery Agents with "Bitlocker to Go" drives "“ Part 2"
date: 2010-01-09 13:09:17
author: admin
categories: ["Best Practice", "Security", "Tutorials"]
tags: ["Advanced", "Bitlocker", "Bitlocker to Go", "Certificate", "Data Recovery Agent", "Group Policy", "Security", "USB"]
featured_image: "https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb27.png"
---

As I previously mentioned in Part 1 "use Group Policy to save "[How to use BitLocker to Go" recovery keys in Active Directory "“ Part 1](<https://www.grouppolicy.biz/2010/01/how-to-use-group-policy-to-save-bitlocker-to-go-recovery-keys-in-active-directory-part-1/>)" one of the cool new features in Windows 7 is the ability to encrypt removable storage devices to help prevent the loss of data within an organisation while storing a copy of the decryption key in Active Directory. Another way to encrypt the removable storage devices and still have the ability to recover a encrypted devices if the unlock key is lost is to use a Data Recovery Agent digital certificate. Now before you begin you first need to have deployed you a PKI infrastructure in your organisation so that you can issue the data recovery certificate to your nominated recovery agents. So lets get started"...

### How to configured Group Policy to use a Data Recovery Agent with "BitLocker to Go" drives

#### Issuing the EFS Data Recovery Agent

First you need to create/issue at least one account with the Data Recovery Agent certificate that will be used for when encrypting all the Bitlocker to Go drives. Step 1. Click **Start** , and then type **certmgr.msc** to open the Certificates snap-in Step 2. In the console tree, expand **Personal** , and then click **Certificates**. Step 2. Right click on **Certificates** and click on **All Tasks** and then **Request New Certificate"...** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb27.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image29.png>) Step 3. Click **Next** to the first page of the Certificate Enrollment wizard and then then click on **Active Directory Enrollment Policy** and click **Next** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb28.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image30.png>) Step 4. Tick the **EFS Recovery Agent** policy and then click **Enroll** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb29.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image31.png>) Step 5. Click **Finish** once your account has enrolled as the EFS Recovery Agent certificate. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb30.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image32.png>) You should now see the File Recovery Certificate in you Personal Certificate store. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb31.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image33.png>)

#### Exporting the DRA Certificate

You now need to export the DRA certification information to be used in the BitLocker Drive Encryption group policy in a future step.  Step 1. Double-click the **BitLockerDRA** certificate to display the certificate properties sheet. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb32.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image34.png>) Step 2. Click the **Details** tab [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb33.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image35.png>) Step 3. Click **Copy to File** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb34.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image36.png>) Step 4. Click **Next** on the **Welcome to the Certificate Export Wizard** page [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb35.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image37.png>) Step 5. Leave the **No, do not export the private key** selected and then click **Next**. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb36.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image38.png>) Step 6. On the **Export File Format** page, verify that **DER encoded binary x.509 (.CER)** is selected, and then click **Next**. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb37.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image39.png>) Step 7. On the **File to Export** page, click **Browse** to display the **Save as** dialog box. In **File name** , type **BitLocker**. In **Save as type** , verify that **DER Encoded Binary X.509 (.cer)** is selected, and then click **Save** to return to the **File to Export** page. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb38.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image40.png>) Step 8. The **File name** box on the wizard page should now display the path to the BitLocker.cer file in your document library. Click **Next**. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb39.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image41.png>) Step 9. On the **Completing the Certificate Export Wizard** page, verify that the information displayed is correct, and then click **Finish**. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb40.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image42.png>) Step 10. When the certificate has been exported, the **Certificate Export Wizard** dialog box will be displayed with the message **The export was successful**. Click **Close** to close the dialog and the wizard.

#### Configuring the Bitlocker Data Recovery Agent in Group Policy

In this section we are going to take the Data Recover Agent certificate we exported above and import it into the group policy to apply to computers that will have DRA certification for encrypting Bitlocker drives. The screenshots below are from a Windows Server 2008 R2 server with the group policy management console installed but if you are on a Windows 7 computer you will need to have install the [Remote Server Admin Tools](<http://www.microsoft.com/downloads/details.aspx?FamilyID=7d2f6ad7-656b-4313-a005-4e344e43997d&displaylang=en>) installed. Step 1. Click **Start** , type **gpedit.msc** in the **Search programs and files** box, and then press ENTER. Step 2. If the **User Account Control** dialog box appears, confirm that the action it displays is what you want, and then click **Yes**. Step 3. In the console tree under **Local Computer Policy\Computer Configuration\Windows Settings\Security Settings\Public Key Policies** , right-click **BitLocker Drive Encryption** , and then click **Add Data Recovery Agent** to start the Add Recovery Agent Wizard. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb41.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image43.png>) Step 4. Click **Next** on the Add Recovery Agent Wizard welcome screen [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb42.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image44.png>) Step 5. On the **Select Recovery Agents** page, click **Browse Folder** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb43.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image45.png>) Step 6. Browse to the location you have a copy of the **BitLocker.cer** file that you exported in the previous procedure select the certificate and click **Open** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb44.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image46.png>) Step 7. Click [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb45.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image47.png>) **Note:** You can repeat this process as necessary to add multiple data recovery agents. After all data recovery agent certificates you want to use have been specified, click **Next**. **Note:** The example above has USER_UNKNOWN because the DRA file was manually imported. Step 8. On the **Completing the Recovery Agent Wizard** page, click **Finish** to add the data recovery agent [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb46.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image48.png>) Below is the BitLocker Drive Encryption setup with a DRA installed. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb47.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image49.png>)

#### Additional Group Policy Configuration

**BitLocker Identification Field** You now need to configure the BitLocker Identification field on all the computers you are going to use Bitlocker on as this helps identify what removable devices belong to your organisation. Step 1. Click **Start** , type **gpedit.msc** in the **Search programs and files** box, and then press ENTER. Step 2. If the **User Account Control** dialog box appears, confirm that the action it displays is what you want, and then click **Yes**. Step 3. In the console tree under **Computer Configuration\Administrative Templates\Windows Components\Bitlocker Drive Encryption** and then double click on **Provide the unique identifiers for your organization** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb48.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image50.png>) Step 3. Enter you specific Bitlocker identification name that you use to identify your Bitlocker encrypted devices in the **BitLocker identification field** **Note:** You can add additional Bitlocker identifiers from other trusted organisations in the **Allowed BitLocker identification field**  [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb49.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image51.png>) **Enable Allow Data Recovery Agent** Continuing on from above you will need to configure you computers to Allow the Data Recovery Agent option. Step 4 (cont.). In the console tree under **Computer Configuration\Administrative Templates\Windows Components\Bitlocker Drive Encryption\Removable Data Drive** and then double click on **Choose how Bitlocker-protected removable drives can be recovered** , then you will need to click **Enabled** and tick **Allow data recovery agent** then click **OK** **Note:** You still have the option of configuring the standard AD recovery keys in this window. The Allow Data Recovery Agent option as far as I can tell has no bearing of the other options. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb50.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image52.png>) You have now configured Group Policy to use a Data Recovery Agent certificate to be used to encrypt all the "Bitlocker to Go" drives in your organisation.

### How to unlock a "BitLocker to Go" drive with a Data Recovery Agent

Below are the instructions explaining how to use the Data Recovery Agent to unlock a BitLocker to Go encrypted drive Step 1. Put the drive into the computer you want to unlock. Step 2. Right Click on a **Command Prompt** , and then click **Run as administrator**. If the **User Account Control** dialog box appears, confirm that the action it displays is what you want, and then click **Yes**. Step 3 (optional). If you want to get information on the volume before you unlock it you can run **manage-bde -status E:** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb51.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image53.png>) Step 4. Now you need to get the "CertificateThumbprint" of the drive you want to unlock type the command **manage-bde "“protectors "“get E:** where E: is the volume you are trying to unlock [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb52.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image54.png>) Note: Take a note of the **Data Recovery Agent (Certificate Based) Certificate Thumbprint**(see circled in red). Tip: You could also mark the thumbprint by using the **Edit** > **Mark** option of the command prompt. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb53.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image55.png>) Then select the thumbprint by clicking on the first character of the thumbprint and dragging to the last character. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb54.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image56.png>) Step 4. To unlock the drive, type the following command **Manage-bde "“unlock E:** **-cert "“ct 88d07b2874031569e17eedf402e0a098fc0f7b81** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb55.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image57.png>) You have now successfully unlocked the drive using a Data Recovery Agent. Note: You will need to have the Data Recovery Agent Certificate (with the private key) installed in the Personal certificate store on the computer you are performing this task. Step 5 (optional). Try getting running the following command again to view more information about the drives encryption **manage-bde -status E:** [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb56.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image58.png>) Form more information about BitLocker drive encryption with Data Recovery Agents see the following pages:

  * [Microsoft TechNet: Configuring the BitLocker Identification Field (Windows 7)](<http://technet.microsoft.com/en-us/library/ee424309\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/ee424309\(WS.10\).aspx")
  * [Microsoft TechNet: Using a Data Recovery Agent to Recover Bitlocker-Protected Drives](<http://technet.microsoft.com/en-us/library/ee424312\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/ee424312\(WS.10\).aspx")
  * [Microsoft TechNet: Using Data Recovery Agents with Bitlocker](<http://technet.microsoft.com/en-us/library/dd875560\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/dd875560\(WS.10\).aspx")

Alan Burchill