---
title: "How to use Group Policy to save "BitLocker to Go" recovery keys in Active Directory "“ Part 1"
date: 2010-01-09 13:03:52
author: admin
categories: ["Best Practice", "Security", "Tutorials"]
tags: ["Active Directory", "Advanced", "Bitlocker to Go", "Group Policy", "Security", "USB"]
featured_image: "https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb14.png"
---

One of the cool new feature in Windows 7 Ultimate and Enterprise is the ability to encrypt USB devices with a password to protect the data from falling into the wrong hands. One of the problem with this is that if a user were to ever forget the unlock key then they will need to remember where they kept the recovery file or paper print out of the 48 digit recovery key. Now for a consumer this feature this might be fine as you keep can keep the key in a fire proof safe or even a locked filing cabinet but if you are managing this in a corporate environment you might have to keep track of thousands or even ten's of thousands of these devices to keep track of the recovery key. Well there is where group policy can be your saviour".... of course! In Part 1 of this "how to" I am going to show you how to setup the recovery key archiving into Active Directory. In Part 2 I will show you how to use Group Policy with Active Directory Certificate Services to enable a Data Recovery Agent so that all your devices can be recovery using a single EFS recovery agent account. **Part 1** Using group policy you can mandate that all encrypted removable device must first have the recover key stored in Active Directory before they start to encrypt. This ensures that for any USB encrypted devices in your organisation that you will always have the ability to unlock the data on the drive even in case that someone forgets the unlock password. Now before we begin there are a few pre-requisites that we need to cover to make sure this work. 1\. You Active Directory must be running the Windows Server 2003 R2 scheme extensions. But I hear you say "you said that Group Policy Preferences doesn't need schema changes to work" well yes"... this is still true it is not a group policy requirement it is a BitLocker requirement. 2\. You should install the "BitLocker Drive Encryption Administration Utilities" with Windows Server 2008 R2 or with the RSAT tools for Windows 7 (see image 1.) on at least one computer in your organisation. This computer can then be used to search for and view the recovery keys if you ever need them. This is a new tool with 2008 R2/Windows 7 and makes it MUCH easier to read the recovery keys than back in the 2003 R2/Vista days. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb14.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image15.png>) **Image 1. Installing "BitLocker Drive Encryption Administration Utilities"** **_How to configured Group Policy to save the Recovery Key?_** Now before I go on I will assume that you are already familiar with Group Policy so all I am going to cover is the key (pardon the pun) policies you need to ensure the recovery keys are backed up to AD DS for all your removable USB storage devices in your organisation. Step 1. Edit the group policy that you have applied to all your workstations and navigate to Computer > Policies > Administrative Templates > Windows Components > BitLocker Drive Encryption > Removable Data Drives. Here the two policies you need to enable are "Deny write access to removable drives not protected by BitLocker" and "Choose how BitLocker-protected Removable drives can be recovered" (see Image 2). [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb15.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image16.png>) **Image 2. Removable Data Drives BitLocker Drive Group Policy** Step 2. When you Enable the "Deny write access to removable drives not protected by BitLocker" also tick the "Do not allow write access to devices configured in another organization" option (see Image 3). This setting is important as it will make any non-BitLocker encrypted devices from being written to in your organisation thus bypassing the whole reason to use BitLocker. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb16.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image17.png>) **Image 3. Deny write access to removable drives not protected by BitLocker** Step 3. Now Enable the "Choose how BitLocker-protected Removable drives can be recovered" and make sure that the "Save BitLocker recovery information to AD DS for removable data drives" and the "Do not enable BitLocker until recovery information is stored to AD DS for removable data drives" are both ticked (See image 4.). This setting ensures the computer has successfully saved recovery key into AD before encrypting a USB storage device. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb17.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image18.png>) **Image 4. Choose how BitLocker-protected removable drives can be recovered** You may also want to consider ticking the "Omit recovery option form the BitLocker setup wizard" as this will prevent you users from saving the recovery key manually which might be desirable if you don't trust them to store the key in a safe place. Because of the "Do not enable BitLocker until recovery information is stored to AD DS for removable data drives" option has been ticked if the user tries to encrypt a new USB storage device when not connected to the corporate network then they will get the following error message (see image 5). [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb18.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image19.png>) **Image 5. Error saving recovery key** If the user is out of the office they will need to establishing a VPN connection or enable BitLocker on the device the next time they are in the Office. This would not be a problem if you have configured Direct Access but this is a post for another time. Note: The loop hole to this is that if someone already had a BitLocker to Go encrypted device and plugs it into a computer they will be able to save information to the device. This does not mean the data will not be encrypted its just you wont have the recovery key if they forget the password to that particular device. To help with this problem you can set the BitLocker identification field on all the computers in the organisation so they will reject all encrypted devices that don't have the same identification field value. This setting is under Computer > Policies > Administrative Templates > Windows Components > BitLocker Drive Encryption called "Provide the unique identifiers for your organization" (see image 6.). This might sound like you can mandate outside memory sticks can't be used in your organisation but if someone has set the identification field to the same value this would get around option. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb19.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image20.png>) **Image 6. Provide the unique identifiers for your organization** **_How to recover the BitLocker recovery password in AD?_** So you have deployed BitLocker to your organisation and you have told everyone to be careful to remember the passwords but of course your manger has come to you saying that they have forgotten the password for his USB memory stick and it has the only copy of some really important files on it that he has have for a meeting tomorrow. What do you do? Step 1. First we need to identify the USB devices Recovery key identifier by plugging it into a computer running Windows 7 Ultimate/Enterprise. You can then find this identifier by clicking on the "I forgot my password" option (see image 7.) [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb20.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image21.png>) **Image 7. I forgot my password** Step 2. Then write down the 8 characters of the recovery key identifier (See image 8.) [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb21.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image22.png>) **Image 8. Recovery key identifier** Step 3. Now go to the computer that you installed the "BitLocker Recovery Password Viewer" tool that I previously mentioned above launch "Active Directly Users and Computers" MMC snap-in with and account with Domain Admin privileges. Click on the domain name that will have the recovery key saved and then click "Action" and then "Find BitLocker Recovery Password"..." (see image 9.). [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb22.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image23.png>)  **Image 9. "Find BitLocker Recovery Password"..."** Step 4. Now type the first 8 characters you wrote down in step 2. and click "Search" (See Image 10.). This will show you the Recovery Password in the Details pane that you will need to unlock the drive. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb23.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image24.png>) **Image 10. Find BitLocker Recovery Password"..."** Step 5. Now go back to the computer you have plugged the USB device into and click on "Type the recovery key" (see image 7.). Step 6. Now type the 48 digit Recovery Password into the text box and click "Next" (see image 11.) [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb24.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image25.png>) **Image 11. Enter your recovery key** Step 7. Click OK and you will now be able to read the required file off this drive (See Image 12.). [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb25.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image26.png>) **Image 12. You cannot save file on this drive** Note: If you want to restore the drive back to normal you will need to go to the control panel and go into the "Manage BitLocker" option to "Turn off BitLocker" (see Image 13.) on the device and then go back and select the option to "Turn On BitLocker" again. This will completely reset the recovery key on the device making the one you just recovered totally invalid. [![image](https://www.grouppolicy.biz/wp-content/uploads/2010/01/image_thumb26.png)](<https://www.grouppolicy.biz/wp-content/uploads/2010/01/image28.png>) **Image 13. Control Panel BitLocker Drive Encryption option** Part 2 can now be found here "[How to configure Group Policy to use Data Recovery Agent to encrypt "Bitlocker to Go" drives "“ Part 2](<https://www.grouppolicy.biz/2010/01/how-to-configure-group-policy-to-use-data-recovery-agents-with-bitlocker-to-go-drives-part-2/>)"