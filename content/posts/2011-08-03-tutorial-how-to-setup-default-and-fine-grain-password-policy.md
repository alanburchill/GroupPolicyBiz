---
title: "Tutorial: How to setup Default and Fine Grain Password Policy"
date: 2011-08-03 11:37:00
author: admin
categories: ["Tutorials"]
tags: ["Default Domain", "FGPP", "Password", "Password Policy", "PSO"]
featured_image: "https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb.png"
---

[![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image.png>)One strange thing that still seems to catch a lot of people out is that you can only have one password policy for your user per domain. This catches a lot of people out as they apply a password policy to an OU in their AD thinking that it will apply to all the users in that OU".... but it doesn't. Microsoft did introduce Fine Grain Password Policies with Windows Server 2008 however this can only be set based on a security group membership and you still need to use the very un-user-friendly ADSI edit tool to make the changes to the policy. Below I will go through how you change the default domain password policy and how you then apply a fine grain password policy to your environment. The Good news is setting the default password policy for a domain is really easy. The Bad news is that setting a fine grain password policy is really hard. **Update:** If you want to set a password complexity setting that is not supported out of the box of windows then it is possible to install a third-party DLL on you domain controllers to achieve this. However there are many caveats to this and it is best you check out the full explanation at <http://blogs.technet.com/b/askds/archive/2011/08/05/friday-mail-sack-beard-seconds-edition.aspx#password>

### How to set a Default Domain Password Policy

**Step 1.** Create a new Group Policy Object at the top level of the domain (e.g. "Domain Password Policy"). [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb1.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image1.png>) **Note:** I have elected to create a new GPO at the top of the domain in this case as I always try to avoid modifying the "Default Domain Policy", see references below.

#### Reference

[TechNet: Linking GPOs](<http://technet.microsoft.com/en-us/library/cc736813\(WS.10\).aspx>)

> If you need to modify some of the settings contained in the **Default Domain Policy GPO** , it is recommended that you create a new GPO for this purpose, link it to the domain, and set the **Enforce** option.

[TechNet: Establishing Group Policy Operational Guidelines](<http://technet.microsoft.com/en-us/library/cc779159\(WS.10\).aspx>)

> Do not modify the default domain policy or default domain controller policy unless necessary. Instead, create a new GPO at the domain level and set it to override the default settings in the default policies.

**Step 2.** Edit the "Domain Password Policy" GPO and go to Computer Configurations>Policies>Windows Settings>Security Settings>Account Policy>Password Policy and configured the password policies settings to the configuration you desire. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb2.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image2.png>) **Step 3.** Once you have configured the password policy settings make the "Domain Password Policy" GPO the highest in the Linked GPO processing order. **TIP:** Make sure you inform all your users when you are going to do this as it may trigger them to change their password the next time they logon. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb3.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image3.png>) Done"... told you it was easy".... **Note:** Even if you apply the password policies to the "Domain Controllers" OU it will not modify the domain's password policy. As far as I know this is the only exception to the rule as to how GPO's apply to objects. As you can see in the image below the "Minimum password length" in the "Domain Password Policy" GPO is still applied to the domain controller even though I have another GPO linking to the "Domain Controllers" OU configuration the same setting. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb4.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image4.png>) For a better explanation as to why the GPO that is linked to the Domain and not the Domain Controllers is used for the password policy for all users check out [Jorge's Quest for Knowledge! - Why GPOs with Password and Account Lockout Policy Settings must be linked to the AD domain object to be affective on AD domain user accounts](<http://blogs.dirteam.com/blogs/jorge/archive/2008/12/16/why-gpos-with-password-and-account-lockout-policy-settings-must-be-linked-to-the-ad-domain-object-to-be-affective-on-ad-domain-user-accounts.aspx> "http://blogs.dirteam.com/blogs/jorge/archive/2008/12/16/why-gpos-with-password-and-account-lockout-policy-settings-must-be-linked-to-the-ad-domain-object-to-be-affective-on-ad-domain-user-accounts.aspx")

### How to set a Fine Grain Password Policy

Fine Grain Password Policies (FGPP) were introduced as a new feature of Windows Server 2008. Before this the only way to have different password polices for the users in your environment was to have separate domains"... OUCH!

#### Pre-Requisites/Restrictions

You domain must be Windows Server 2008 Native Mode, this means ALL of your domain controllers must be running Windows Server 2008 or later. You can check this by selection the "Raise domain functional level" on the top of the domain in Active Directory Users and Computers. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb5.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image5.png>)

#### Reference

[AD DS: Fine-Grained Password Policies](<http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx")

> The domain functional level must be Windows Server 2008.

The other restriction with this option is that you can only apply FGPP to users object or users in global security groups (not computers).

#### Reference

[AD DS: Fine-Grained Password Policies](<http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx")

> Fine-grained password policies apply only to user objects "... and global security groups.

**TIP:** If you setup an "[Automatic Shadow Group](<http://policelli.com/blog/archive/2008/01/15/manage-shadow-groups-in-windows-server-2008/>)" you can apply these password policies to users automatically to any users located in an OU.

#### Creating a Password Setting Object (PSO)

**Step 1.** Under Administrator Tools Open ADSI Edit and connect it to a domain and domain controller you want to setup the new password policy. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb6.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image6.png>) **Note:** If you do not see this option go to "Turn Windows Features On or Off" and make sure the "AD DS and AD LDS Tools" are installed. (You will need [RSAT](<https://www.grouppolicy.biz/2010/03/how-to-download-and-install-the-group-policy-management-console-gpmc/>) also installed if you are on Windows 7).\ **Step 2.** Double click on the "CN=_DomainName_ " then double click on "CN=System" and then double click on "CN=Password Settings Container". [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb7.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image7.png>) **Step 3.** Right click on "CN=Password Settings Container" and then click on "New" then "Object"..." [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb8.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image8.png>) **Step 4.** Click on "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb9.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image9.png>) **Step 5.** Type the name of the PSO in the "Value" field and then click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb10.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image10.png>) **Note:** With the exception of the password length the following values are all the same as the default values in the "Default Domain Policy". **Step 6.** Type in a number that will be the Precedence for this Password Policy then click "Next". **Note:** This is used if a users has multiple Password Settings Object (PSO) applied to them. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb11.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image11.png>) **Step 7.** Type "FALSE" in the value field and click "Next" **Note:** You should almost never use "TRUE" for this setting. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb12.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image12.png>) **Step 8**. Type "24" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb13.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image13.png>) **Step 9.** Type "TRUE" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb14.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image14.png>) **Step 10.** Type "5" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb15.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image15.png>) **Step 11.** Type "1:00:00:00" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb16.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image16.png>) **Step 12.** Type "42:00:00:00" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb17.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image17.png>) **Step 13.** Type "10" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb18.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image18.png>) **Step 14.** Type "0:00:30:00" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb19.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image19.png>) **Step 15.** Type "0:00:33:00" in the "Value" field and click "Next" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb20.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image20.png>) **Step 16.** Click "Finish" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb21.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image21.png>) You have now created the Password Settings Object (PSO) and you can close the ADSIEdit tool. Now to apply the PSO to a users or group"... **Step 17.** Open Active Directory Users and Computers and navigate to "System > Password Settings Container" **Note:** Advanced Mode needs to be enabled. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb22.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image22.png>) **Step 18.** Double click on the PSO you created then click on the "Attribute Editor" tab and then select the "msDS-PSOAppliedTo" attribute and click "Edit" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb23.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image23.png>) Step 19. Click "Add Windows Accounts"...." button. [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb24.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image24.png>) **Step 20.** Select the user or group you want to apply this PSO and click "OK" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb25.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image25.png>) **Step 21.** Click "OK" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb26.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image26.png>) **Step 22.** Click "OK" [![image](https://www.grouppolicy.biz/wp-content/uploads/2011/08/image_thumb27.png)](<https://www.grouppolicy.biz/wp-content/uploads/2011/08/image27.png>) And your are done"... (told you it was hard). Fine Grain Password Policies as you can see are very difficult to setup and manage so it is probably best you use them sparingly in your organisation"... But if you really have to have a simple password or extra complicated password then at least it give you away to do this without having to spin up another domain. **Other Useful Links** [AD DS: Fine-Grained Password Policies](<http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/cc770394\(WS.10\).aspx") [AD DS Fine-Grained Password and Account Lockout Policy Step-by-Step Guide](<http://technet.microsoft.com/en-us/library/cc770842\(WS.10\).aspx> "http://technet.microsoft.com/en-us/library/cc770842\(WS.10\).aspx") [Why GPOs With Password And Account Lockout Policy Settings Must Be Linked To The AD Domain Object To Be Affective On AD Domain User Accounts](<http://jorgequestforknowledge.wordpress.com/2008/12/16/why-gpos-with-password-and-account-lockout-policy-settings-must-be-linked-to-the-ad-domain-object-to-be-affective-on-ad-domain-user-accounts/> "Why GPOs With Password And Account Lockout Policy Settings Must Be Linked To The AD Domain Object To Be Affective On AD Domain User Accounts")